{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>–ü–∞–Ω–µ–ª—å –º–∞—Å—Ç–µ—Ä–∞</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <link rel="stylesheet" href="{% static 'miniapp/style.css' %}?v=22" />
  <style>
    body{margin:0;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,system-ui}
    .bg-gradient{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh}

    .container{max-width:400px;margin:0 auto;padding:20px;min-height:100vh;display:flex;flex-direction:column}
    .header{text-align:center;margin-bottom:32px;padding-top:12px}
    .master-logo{width:100px;height:100px;border-radius:50%;
      background:linear-gradient(135deg,#FF6B6B,#FF8E8E);display:flex;align-items:center;justify-content:center;
      font-size:40px;color:#fff;margin:0 auto 16px;box-shadow:0 8px 32px rgba(255,107,107,.3);border:4px solid rgba(255,255,255,.2)}
    .welcome-text{color:#fff;font-size:24px;font-weight:700;margin:0 0 4px}
    .master-name{color:rgba(255,255,255,.85);font-size:16px}

    .menu-grid{display:grid;grid-template-columns:1fr 1fr;gap:16px;align-content:start}
    .menu-button{background:rgba(255,255,255,.95);border:1px solid rgba(255,255,255,.2);border-radius:20px;
      padding:24px 16px;cursor:pointer;display:flex;flex-direction:column;align-items:center;gap:10px;
      text-decoration:none;color:#222;box-shadow:0 4px 20px rgba(0,0,0,.08);backdrop-filter:blur(8px);transition:.25s}
    .menu-button:hover{transform:translateY(-4px);box-shadow:0 10px 28px rgba(0,0,0,.14);background:#fff}
    .menu-icon{width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:24px;color:#fff}
    .appointments-icon{background:linear-gradient(135deg,#4ECDC4,#44A08D)}
    .profile-icon{background:linear-gradient(135deg,#667eea,#764ba2)}
    .services-icon{background:linear-gradient(135deg,#f093fb,#f5576c)}
    .calendar-icon{background:linear-gradient(135deg,#ffecd2,#fcb69f);color:#8B4513}
    .menu-title{font-weight:700}
    .menu-subtitle{font-size:12px;color:#666;text-align:center}

    .stats{margin-top:22px;background:rgba(255,255,255,.10);border:1px solid rgba(255,255,255,.25);
      border-radius:16px;padding:18px;backdrop-filter:blur(8px);color:#fff}
    .stats h3{margin:0 0 12px;text-align:center;font-size:16px}
    .stats-grid{display:grid;grid-template-columns:1fr 1fr;gap:16px;text-align:center}
    .stat-num{font-size:22px;font-weight:800}
    .stat-label{font-size:12px;color:rgba(255,255,255,.82)}

    /* –æ–±–ª–∞—Å—Ç—å —ç–∫—Ä–∞–Ω–æ–≤ */
    #appArea{display:none;max-width:640px;margin:0 auto;padding:12px 14px 22px}
    #content{margin-top:6px}

    /* —à–∞–ø–∫–∞ —ç–∫—Ä–∞–Ω–æ–≤ —Å–æ —Å—Ç—Ä–µ–ª–∫–æ–π */
    .cb-header{position:sticky;top:0;z-index:5;background:transparent}
    .cb-header__row{display:flex;align-items:center;gap:10px}
    .cb-back{border:0;background:rgba(0,0,0,.35);color:#fff;border-radius:10px;padding:10px 12px;font-size:16px;cursor:pointer}
    .cb-title{color:#fff;font-size:18px;font-weight:800;margin:0}
    .cb-sep{height:1px;background:rgba(255,255,255,.25);margin:10px 0}

    /* –æ–±—â–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –≤ –ø–∞–Ω–µ–ª–∏ */
    .cb-wrap{padding:6px 0}
    .booking-item{background:#121a24;border:1px solid #223244;border-radius:14px;padding:12px;color:#e7eef7}
    .input{background:#0f1720;border:1px solid #223244;color:#e7eef7;border-radius:10px;padding:10px}

    /* —Å–µ–∫—Ü–∏–∏ –¥–∞—Ç/—Å–ª–æ—Ç–æ–≤ */
    .date-section{background:#0f1720;border:1px solid #223244;border-radius:16px;padding:14px;margin-bottom:12px;color:#e7eef7}
    .date-header{display:flex;align-items:center;gap:10px;border-bottom:1px solid #223244;padding-bottom:8px;margin-bottom:10px}
    .date-number{width:42px;height:42px;border-radius:10px;background:#2f7de7;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700}
    .date-info .date-month{opacity:.85;font-size:13px}
    .time-slots{display:grid;grid-template-columns:repeat(auto-fit,minmax(86px,1fr));gap:8px}
    .time-slot{background:#0b1220;border:1px solid #223244;border-radius:10px;padding:10px 6px;text-align:center;cursor:pointer}
    .time-slot:hover{transform:translateY(-1px);border-color:#2f7de7}
    .time-slot.occupied{opacity:.45;cursor:not-allowed;border-style:dashed}
      /* ==== –ó–∞–ø–∏—Å–∏ –º–∞—Å—Ç–µ—Ä–∞ ‚Äì –∫–∞—Ä—Ç–æ—á–∫–∏, —Ñ–∏–ª—å—Ç—Ä—ã, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ ==== */
.filters-tabs{display:flex;gap:8px;margin-bottom:12px;overflow-x:auto;padding-bottom:4px}
.filter-tab{background:rgba(255,255,255,.12);border:1px solid #223244;border-radius:20px;padding:8px 14px;font-size:13px;color:#e7eef7;cursor:pointer;white-space:nowrap;transition:.2s}
.filter-tab:hover{background:rgba(255,255,255,.18)}
.filter-tab.active{background:#2f7de7;border-color:#2f7de7;color:#fff}

.stats-grid-3{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:12px}
.stat-card{background:#0f1720;border:1px solid #223244;border-radius:12px;padding:12px;text-align:center}
.stat-number{font-size:20px;font-weight:800}
.stat-number.confirmed{color:#49d27a}
.stat-number.pending{color:#ffb847}
.stat-number.rejected{color:#ff6b6b}
.stat-label{font-size:12px;opacity:.8}

.appointments-list{display:flex;flex-direction:column;gap:12px}
.appointment-card{background:#0f1720;border:1px solid #223244;border-radius:16px;padding:16px;position:relative}
.appointment-card.pending{border-color:#ffb84733;box-shadow:0 0 0 1px #ffb84722 inset}
.appointment-card.confirmed{border-color:#49d27a33;box-shadow:0 0 0 1px #49d27a22 inset}
.appointment-card.rejected{border-color:#ff6b6b33;box-shadow:0 0 0 1px #ff6b6b22 inset;opacity:.85}

.appointment-status{position:absolute;top:12px;right:12px;padding:4px 10px;border-radius:20px;font-size:12px;font-weight:600}
.status-pending{background:#ffb847;color:#121212}
.status-confirmed{background:#49d27a;color:#121212}
.status-rejected{background:#ff6b6b;color:#121212}

.appointment-header{display:flex;align-items:center;gap:12px;margin-bottom:12px;padding-right:84px}
.client-avatar{width:44px;height:44px;border-radius:50%;background:linear-gradient(135deg,#2f7de7,#5BA3F5);display:flex;align-items:center;justify-content:center;font-size:16px;color:#fff;flex-shrink:0;font-weight:700}
.appointment-info{flex:1}
.client-name{font-size:15px;font-weight:700;color:#e7eef7}
.appointment-service,.appointment-time{font-size:13px;opacity:.85}

.appointment-actions{margin-top:10px;padding-top:10px;border-top:1px solid #223244;display:flex;gap:10px}
.action-button{flex:1;padding:10px 12px;border:none;border-radius:10px;font-size:14px;font-weight:600;cursor:pointer;transition:.15s}
.accept-button{background:#49d27a;color:#0c151e}
.accept-button:hover{filter:brightness(1.05);transform:translateY(-1px)}
.reject-button{background:#ff6b6b;color:#0c151e}
.reject-button:hover{filter:brightness(1.05);transform:translateY(-1px)}

.empty-state{ text-align:center;padding:40px 12px;opacity:.85 }
.empty-icon{font-size:42px;margin-bottom:8px}
.empty-title{font-size:16px;font-weight:700;margin-bottom:4px}
.empty-subtitle{font-size:13px}

  </style>
</head>
<body class="bg-gradient">

  <section id="homePanel" class="container">
    <div class="header">
      <div class="master-logo" id="masterLogo">üë©‚Äçüíº</div>
      <h1 class="welcome-text">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h1>
      <p class="master-name" id="masterName">‚Äî</p>
    </div>

    <div class="menu-grid">
      <button class="menu-button" data-act="appointments">
        <div class="menu-icon appointments-icon">üìã</div>
        <div class="menu-title">–ü–æ–∫–∞–∑–∞—Ç—å –∑–∞–ø–∏—Å–∏</div>
        <div class="menu-subtitle">–ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π</div>
      </button>

      <button class="menu-button" data-act="profile">
        <div class="menu-icon profile-icon">üë§</div>
        <div class="menu-title">–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</div>
        <div class="menu-subtitle">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è</div>
      </button>

      <button class="menu-button" data-act="services">
        <div class="menu-icon services-icon">‚ú®</div>
        <div class="menu-title">–£—Å–ª—É–≥–∏ –∏ —Å–ª–æ—Ç—ã</div>
        <div class="menu-subtitle">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å–ª—É–≥–∞–º–∏</div>
      </button>

      <button class="menu-button" data-act="calendar">
        <div class="menu-icon calendar-icon">üìÖ</div>
        <div class="menu-title">–ö–∞–ª–µ–Ω–¥–∞—Ä—å</div>
        <div class="menu-subtitle">–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã</div>
      </button>
    </div>

    <div class="stats" id="todayStats">
      <h3>–°–µ–≥–æ–¥–Ω—è</h3>
      <div class="stats-grid">
        <div>
          <div class="stat-num" id="statTotal">0</div>
          <div class="stat-label">–ó–∞–ø–∏—Å–µ–π</div>
        </div>
        <div>
          <div class="stat-num" id="statPending">0</div>
          <div class="stat-label">–û–∂–∏–¥–∞–Ω–∏–µ</div>
        </div>
      </div>
    </div>

    <div id="noTid" class="booking-item" style="margin-top:12px;display:none">
      <b>–ù–µ—Ç Telegram ID</b><br/>
      –û—Ç–∫—Ä–æ–π—Ç–µ –ø–∞–Ω–µ–ª—å —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É –≤ –±–æ—Ç–µ.<br/>
      –î–ª—è –æ—Ç–ª–∞–¥–∫–∏ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å <code>?tid=–í–ê–®_ID</code> –∫ URL.
    </div>
  </section>

  <section id="appArea">
    <div id="content"></div>
  </section>

  <div id="loader" class="loader"><div class="dot"></div><div class="dot"></div><div class="dot"></div></div>
  <div id="toast" class="toast"></div>

  <script src="{% static 'miniapp/master.js' %}?v=22"></script>
</body>
</html>
